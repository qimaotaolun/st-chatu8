(function(_0x3b24e3,_0x260347){function _0x2e77e0(_0x44e72f,_0x3d5b65,_0x712fc,_0x79f460){return _0x4528(_0x44e72f-0x309,_0x712fc);}const _0x26b741=_0x3b24e3();function _0x199af1(_0x382ca5,_0x5778a6,_0x4c679b,_0x5c7858){return _0x4528(_0x382ca5-0x2f9,_0x4c679b);}while(!![]){try{const _0x140641=-parseInt(_0x2e77e0(0x50a,0x491,0x577,0x48c))/(0x38*-0x9d+0x149d+0xdbc)+-parseInt(_0x2e77e0(0x4d4,0x4c2,0x4cc,0x528))/(-0x705*0x3+-0x117d+0x2c1*0xe)*(-parseInt(_0x199af1(0x451,0x4b4,0x40a,0x4b9))/(-0x1088+-0x1985+-0x10*-0x2a1))+-parseInt(_0x199af1(0x498,0x4d4,0x421,0x4ae))/(0x846+0x5f*0x20+-0x1422)+parseInt(_0x199af1(0x49f,0x4ac,0x4b9,0x518))/(0x425*0x1+-0x6a0+0xa*0x40)*(-parseInt(_0x2e77e0(0x47e,0x490,0x42f,0x424))/(-0x9*0x137+0x291*-0x6+-0x3*-0x8c9))+-parseInt(_0x2e77e0(0x482,0x409,0x41f,0x425))/(0x57e+0x21f1+0x61*-0x68)+parseInt(_0x199af1(0x4f2,0x49a,0x547,0x493))/(0x355*0x2+-0x27*-0x2a+-0xd08)+-parseInt(_0x2e77e0(0x424,0x3f5,0x432,0x481))/(-0x1295+0x263*-0x1+0x1501)*(-parseInt(_0x2e77e0(0x41f,0x49d,0x3e8,0x3d7))/(-0x43f*0x7+-0x1*-0x1232+0xb91));if(_0x140641===_0x260347)break;else _0x26b741['push'](_0x26b741['shift']());}catch(_0x4d7d24){_0x26b741['push'](_0x26b741['shift']());}}}(_0x1934,0x7a0dd*0x1+-0x2f*0x1442+0x9226));function _0x1934(){const _0x258508=['ENbRBNy','DwLSDcbjBwfNzq','qwLjzKS','C2GTAw1Hz2uG5QIH','u2DuDLa','D0PLu2G','Cujbr0K','q2HHCMfJDgvYia','tenzB08','w0jHBMfUyv0GqG','uKHSCwC','Dg9tDhjPBMC','uKLqv3a','zgvSCY8','yxnWzwn0uMf0Aq','whbfBei','ANvnvxK','CIbWCM9TChq6ia','ALjAtNe','ifbYB21WDa','t0vpB0S','CMrvDfu','Aw5PDgLHBgL6zq','B0P1EKq','mti5ntK3Ae1xz3vh','BNnLigzVCIbjra','EhrPD1K','zw1PDa','qMfUyw5HtgLZDa','w0jHBMfUyv0GrW','lwLTywDLioAOOEwEI+oaGG','sNLNqwO','5zU+5lQl5lU255Ur5zcS5zMO5BEY5ywZ6zET44cc','rej5vue','DgLVBIb3AxrOia','ywX3qMe','zw5LCMf0Aw9Uia','y29UDMvYC2f0Aq','sLbwDNu','s1Lsq3e','ywDLigDLBMvYyq','BwL0DgvKigzHAq','5PYa5zco572U','w0jHBMfUyv0Gvq','DwLSDcbhzw1PBG','CMvWBgfJzufSBa','Aw1Hz2vdB25MAq','w0jHBMfUyv0GuW','C2HyEwO','u2nLBMuGq29TCa','qvjesvC','A2HoDvi','Aw5ZDgfUy2vZ','mtjmyujStNm','CMHlu1G','qvD0zvy','5l+U5zU+5lIt55sO6Ake6k6+','mZGWmZe5mvHxBKTTCG','yxLSB2fKoIa','5yIg6kEs6iMY5QIH5BYpoIdOP6pMNPdLUky','DdOG','B3vUzcbTyxrJAa','BwfNzsbNzw5LCG','zw5LCG','ChjVBxb0','5zco572U5zco','ue9tva','BeXXA08','q3byDgu','BhvYzsbYzxnWBW','zxjYB3i','s09WAxi','EfveBwq','z01swvq','sNvlB3q','E+s/RUwBVN0','w0jHBMfUyv0Grq','yMLiDey','y29UC3rYDwn0BW','BKj5v2i','BNn1ChbVCNrLza','Bg9N','AsbWyxLSB2fKia','B3iGChjVBxb0oG','w0jHBMfUyv0G5Qoa','C3nMDwXSEs4','77Ym5Bcg5l2/55sOz2vTAw5P','sNbpCfy','Aw1Hz2veyxrH','zML4zwrqCM9TCa','kcGOlISPkYKRkq','tfjnBfm','Cg9ZDgzPEfbYBW','w0jHBMfUyv0G55sF','qMvHCMvYia','mtG5mdm4ofzbzxvStG','55sO5lQgihVKV67LM759ioApKoEKUG','A1PXCe0','we5YugS','5lIT55QeihbYB21WDooaGG','C2vHCMnO','v1rZBwG','oduZmtu1quzYEvLV','AKvYwNm','y2XPzw50','DgDMvey','DK1ZAu4','BgvZktOG','rKf3ExK','C2fTCgXLq291BG','vK1xsLu','z1LHzxi','zMHnAKG','Bxb0','A2fXu0y','tufhrv9srvfvrq','qxPJsxK','CgfYyw1LDgvYCW','Afbcs3a','5Qch5yEg5QIH5BYpoIdKVB/NLkJOR7FMSyi','tKPSsum','uMfhvMO','BujZwNa','tunjq1q','vufMENO','D2L0AcbWCM9TCa','AgLZDg9YEq','Ce5zzM0','A1HLzuq','yMfUyw5H','55sO5lQo55sF5OIq55QevgfNoIa','BwvZC2fNzq','kerPDMLKzv9YBW','57Yt5A2y6k6+572U5lI65lIn5A2y5ywL5PwW5O2U','t0Dru2m','zw5KAw5NihjLCq','revkuxK','C2f0Aw9UihrVia','r1DxqK8','mtrZyMfpr0e','CM9Szq','ig1VzgvSihnLBa','Chj5yMm','Bw9KzwW','C3rYAw5NAwz5','uw1XAge','yw5HienOyxjHyW','zMLSDgvY','ChvZAa','5yMn572U5yMn','yxbWBhK','CMvTB3zLtgLZDa','rLzVuMm','BxnRDhm','sMfVvfm','Dgv4Da','wMXxs1O','De90ALK','lcdPQ5JLUQyGlsa','t05nz3G','5z2q5Qch55Qe5O+q56s66k+n5A2x56YM5lIY44cc','y2Dyt1q','nxWWFdj8nhWZFa','CMDwvwq','ihWG','ANnVBG','Dg9mB3DLCKnHCW','5Rwl5yIW5yY56ywn55Qe6Ake6k6+oG','zeTUBNi','vMf2s1a','wLbfvw8','C3rHCNrZv2L0Aa','BgvUz3rO','D3nREfy','ignVBNrHAw4GiG','5Q2J6z2I5O+q56s66k+noIa','DhjPBq','yKXzEMq','qw9oB1u','6k+35Rgc5Bc65A+4oIdLRR3LUQyGlq','yvP2ANK','CxnhD3C','DhjPz2DLCNm','DwvZDcb0BZOG','C2ziu0m','mJmYnti4mhv0Cuj2za','6k+n77Ym5Bcg5l2/55sOigDLBwK','zMXHDa','DKLXzKq','Aw1Hz2u','DgLVBIbYzxf1zq','tLPcu3K','w0jHBMfUyv0GuG','ndu2ndG3thj3vvLU','DxnLCG','sKP5txK','C3rHDhvZ','AeXfuwm','ltiUns1MBgfZAa','qunRtfi','tufhrv9srvnqtW','5yMn572U5zco','w0jHBMfUyv0G5zcV','EgHdtw4','tLnf','u01QvMC','BIbWyxLSB2fKia','s2rSDgu','y2vZCYbYzxnWBW','C3bSAxq','w0jHBMfUyv0GrG','z25qBwm','mJiXnZbzBMHbzu0','ieLeia','l3yXl2nOyxqVyW','Ew1uu2S','5B2t5yMn55sF5zU+5QYH5PwW5lI6igzV','nJe0n0HjEu1fvW','CxH4sKS','B3nPDgLVBG','yxbWBgLJyxrPBW','AgLZDg9YEs4','r0vorvjbvevFsq','CMvZDwX0vxjSiG','Aw1Hz2vUltqUma','y2LZAhu','DuDIzMS','zM9YrwfJAa','Aw5NihrYAwDNzq','5zU+5Rwb56Il44cc5A6I5OI356UV5lI6','DgfYDgLUzYbPBq','wuXIEeC','y2HHBMDL','zMfPBgvKigzVCG','ihr1CM5ZlG','C3vJy2vZCW','5zU+5yop5BEY5A2y5ywL5PwW5O2U5BQtigy','zxrJAcbLCNjVCG','AM9PBG','Dg5sqMO','Aw5JBhvKzxm','5zco572U5yMn','BwfW','uLHAvLi','iIbMCM9TiejHBG','BuHcyxO','5BYa5AEliejHBMfUyEEuNW','qMfUyw5H5l+U5zU+5QIH5BYp','yMfUyw5Hq2HHCG','CgfYDhm','lwzSyxnOlwLTyq','Bw9KzwW6ia','vg5nvhu','l3yXyMv0ys9TBW'];_0x1934=function(){return _0x258508;};return _0x1934();}const _0x2aed8c=(function(){const _0x9f7a7d={'OGQSc':function(_0x80ffb0,_0x41734e){return _0x80ffb0(_0x41734e);},'VMWJU':_0x35584b(-0x1de,-0x176,-0x1ec,-0x1b6)+_0x35584b(-0x21b,-0x1e4,-0x200,-0x1c5),'pNYfm':'dtlAv'};function _0x537392(_0x340162,_0x5491ca,_0xec60,_0xe99f00){return _0x4528(_0xec60- -0x336,_0xe99f00);}let _0x10a1ad=!![];function _0x35584b(_0x47e064,_0x2fa9b3,_0x4c2082,_0x1b4123){return _0x4528(_0x4c2082- -0x3a3,_0x1b4123);}return function(_0x3417ea,_0x1bf591){function _0x8e79dd(_0x4df376,_0x1bb340,_0x1a1a6e,_0x2a9716){return _0x35584b(_0x4df376-0x3b,_0x1bb340-0x95,_0x2a9716-0x1ba,_0x1bb340);}function _0x398371(_0x2890c6,_0xfc778,_0x839c53,_0x2aad14){return _0x35584b(_0x2890c6-0x74,_0xfc778-0x17d,_0x2890c6-0x267,_0xfc778);}if(_0x398371(0x80,0x56,0xf4,0x69)!==_0x9f7a7d[_0x398371(0x83,0xbf,0x27,0x22)]){const _0x125e73=_0x10a1ad?function(){function _0x527b05(_0x5a2667,_0x222fdc,_0x5d0428,_0x17acf1){return _0x398371(_0x222fdc- -0xe3,_0x17acf1,_0x5d0428-0x7b,_0x17acf1-0x1a4);}if(_0x1bf591){const _0x2eb3b6=_0x1bf591[_0x527b05(-0x19,-0x49,-0x1c,-0x87)](_0x3417ea,arguments);return _0x1bf591=null,_0x2eb3b6;}}:function(){};return _0x10a1ad=![],_0x125e73;}else _0x9f7a7d[_0x8e79dd(-0x88,0x2d,0xd,-0x23)](_0x39a305,_0x9f7a7d[_0x8e79dd(-0x54,0x33,-0x3,-0x3b)]),_0x51c3e4=_0x50c721;};}()),_0x1dbd93=_0x2aed8c(this,function(){const _0x1d0bd2={};_0x1d0bd2['gnPmc']=_0x38d3f3(0x318,0x323,0x2d8,0x2ac)+'+$';function _0x38d3f3(_0x1ba1ed,_0x499bca,_0x4e196a,_0x57ff89){return _0x4528(_0x4e196a-0x13e,_0x57ff89);}const _0x598508=_0x1d0bd2;function _0x3b1b81(_0x230fae,_0x1e2b63,_0x438a70,_0xf698b){return _0x4528(_0x438a70-0x3d2,_0x1e2b63);}return _0x1dbd93[_0x38d3f3(0x2d8,0x2c3,0x289,0x254)]()[_0x38d3f3(0x35e,0x286,0x2e2,0x324)](_0x598508['gnPmc'])[_0x3b1b81(0x552,0x534,0x51d,0x54e)]()[_0x38d3f3(0x2ba,0x296,0x2cc,0x327)+'r'](_0x1dbd93)[_0x3b1b81(0x506,0x520,0x576,0x50d)](_0x598508[_0x3b1b81(0x4c0,0x492,0x4e7,0x4bf)]);});_0x1dbd93();import{extension_settings}from'../../../../extensions.js';import{eventSource}from'../../../../../script.js';import{extensionName,EventType}from'./config.js';import{sleep,generateRandomSeed,zhengmian,fumian,getRequestHeaders,prompt_replace,addLog,clearLog,parsePromptStringWithCoordinates,prompt_replace_for_character,stripChineseAnnotations}from'./utils.js';import{initializeImageProcessing}from'./iframe.js';import{processCharacterPrompt}from'./characterprompt.js';import{setItemImg}from'./database.js';async function generateBananaImage({prompt:_0x58a3d4,width:_0x40353f,height:_0x47593c,change:_0x26c741}){const _0xc93ddf={'WTsmh':_0x18ed41(0x108,0x105,0xbf,0x14e),'vIqfD':function(_0x559829,_0xed7c1b){return _0x559829(_0xed7c1b);},'xUDmd':function(_0xfa8755,_0x48ece5){return _0xfa8755!==_0x48ece5;},'rhKSX':_0x483c45(0x40c,0x476,0x412,0x402)+'1','wJeSh':'image_url','bLYzd':_0x18ed41(0x158,0xfe,0x19e,0x18f),'mBsZp':function(_0x2b0bb5,_0x3c59be){return _0x2b0bb5+_0x3c59be;},'RXZVR':'user','kaqSF':function(_0x948b9e,_0x8b6037){return _0x948b9e<=_0x8b6037;},'kXeeD':function(_0x22f061,_0x11c428){return _0x22f061+_0x11c428;},'KYRCq':function(_0x30d9e8,_0x3a71aa){return _0x30d9e8(_0x3a71aa);},'uGbfk':function(_0x22ea00,_0x5e0550){return _0x22ea00(_0x5e0550);},'prybc':function(_0x190bed,_0xf9b2a5){return _0x190bed||_0xf9b2a5;},'JJyMy':_0x18ed41(0xee,0xf6,0x100,0xa8)+_0x18ed41(0x9a,0xe3,0x23,0x8e),'jRZNq':function(_0x27b888,_0x955a23){return _0x27b888(_0x955a23);},'SMjVg':_0x483c45(0x3a5,0x375,0x3ab,0x360)+_0x18ed41(0x15d,0x132,0x189,0x172),'kZqpM':function(_0x11ac93,_0x45ba80){return _0x11ac93+_0x45ba80;},'TnMTu':function(_0x49eaac,_0x472cbb){return _0x49eaac(_0x472cbb);},'VavKP':_0x483c45(0x3e1,0x386,0x3dd,0x36d)+_0x18ed41(0x120,0xf4,0xef,0x17d),'alwBa':function(_0x490f36,_0x377f31,_0x49d6c0){return _0x490f36(_0x377f31,_0x49d6c0);},'JbMNV':function(_0x58b4b5,_0x2e5a69){return _0x58b4b5===_0x2e5a69;},'AoNoU':_0x483c45(0x3d9,0x40e,0x40a,0x3e0),'RIPWp':_0x483c45(0x40d,0x3c4,0x3a4,0x3a4),'YDUCj':function(_0x4bfe76,_0x2f8088){return _0x4bfe76+_0x2f8088;},'qBAGI':_0x18ed41(0x161,0x136,0x187,0x117),'zpknv':function(_0x429a8b,_0x45a64c){return _0x429a8b(_0x45a64c);},'ACkLR':_0x18ed41(0x95,0xee,0x7a,0x19)+'ompletions','avAUa':function(_0xcf8f1e,_0xd88715){return _0xcf8f1e!==_0xd88715;},'AWteV':_0x483c45(0x3ae,0x3a1,0x3db,0x3cf),'XNrPk':_0x483c45(0x336,0x31f,0x3af,0x389)+'用了\x20{修图}\x20标识'+_0x483c45(0x3c0,0x402,0x404,0x368)+_0x483c45(0x332,0x325,0x39c,0x32d)+_0x18ed41(0xdb,0x88,0xf0,0x126),'MCICT':_0x18ed41(0x89,0x5d,0x87,0xb4)+_0x18ed41(0x11d,0x181,0x11f,0xc9)+_0x18ed41(0x177,0x1d5,0x12b,0x1bc)+'ni-2.5-fla'+_0x483c45(0x36d,0x391,0x30b,0x32d)+'型。','DByUA':_0x18ed41(0x88,0x93,0xd6,0xc9),'ClAQM':_0x483c45(0x35d,0x35e,0x2df,0x353),'lLqkO':_0x483c45(0x3ab,0x386,0x3da,0x33c),'tJioG':_0x18ed41(0x111,0x12d,0x122,0xcd)+_0x18ed41(0x164,0x1b7,0x1a5,0x181),'fhMjH':function(_0x5fc2f7,_0x11d736){return _0x5fc2f7>_0x11d736;},'Kdlte':_0x483c45(0x3f9,0x475,0x3d2,0x42b),'JygAj':function(_0x3e3d25,_0x23e1b8){return _0x3e3d25+_0x23e1b8;},'JaoTS':function(_0x36d307,_0x1c4bf1){return _0x36d307+_0x1c4bf1;},'tOtjY':function(_0x4f2fb4,_0x1ec7a5){return _0x4f2fb4(_0x1ec7a5);},'ZlWKZ':_0x18ed41(0x9f,0xdb,0xd0,0x86),'juMUy':_0x483c45(0x409,0x390,0x3f5,0x39f),'YLbxG':_0x18ed41(0x99,0x75,0x8e,0xa8),'khNuR':_0x18ed41(0x152,0x1c9,0xe0,0x12f),'ZQCPm':_0x483c45(0x394,0x3c8,0x402,0x3fd),'ZPEUo':_0x483c45(0x3ac,0x331,0x41c,0x342),'JuKot':_0x18ed41(0x9b,0x105,0xd5,0xf4)+'n/json','biHtF':_0x18ed41(0x136,0x113,0xbf,0x106),'DEJQy':'SuSmo','hIYuS':_0x483c45(0x3e0,0x3fe,0x3f4,0x382),'ymTSk':'API\x20respon'+'se\x20did\x20not'+_0x483c45(0x418,0x416,0x410,0x489)+_0x483c45(0x34b,0x3b4,0x36b,0x343),'wskxV':'[Banana]\x20I'+_0x18ed41(0xfb,0xc8,0x93,0xf6)+'ated\x20succe'+_0x18ed41(0x112,0xf6,0x10b,0xa5),'tgfTF':function(_0x297953,_0x5a4f72){return _0x297953(_0x5a4f72);},'xhCMn':_0x18ed41(0x91,0x30,0x10e,0x3c)+_0x18ed41(0xac,0xa7,0x69,0xa8)+':'};_0x58a3d4=_0xc93ddf['KYRCq'](processCharacterPrompt,_0x58a3d4),_0x58a3d4=await stripChineseAnnotations(_0x58a3d4),_0x26c741=_0xc93ddf[_0x18ed41(0xe4,0x109,0xc7,0xa6)](processCharacterPrompt,_0x26c741),_0x26c741=await _0xc93ddf[_0x483c45(0x34e,0x314,0x336,0x329)](stripChineseAnnotations,_0x26c741);let _0x5d0f1d=_0x26c741;_0xc93ddf[_0x18ed41(0xa1,0x8d,0x99,0x88)](addLog,_0x18ed41(0xb5,0x11e,0x9c,0xa6)+_0x483c45(0x351,0x32c,0x3b0,0x31d)+extension_settings[extensionName][_0x483c45(0x3d2,0x395,0x3d3,0x393)]);function _0x483c45(_0x4281ab,_0x23c6bc,_0x1c2cf7,_0xdb2087){return _0x4528(_0x4281ab-0x22a,_0xdb2087);}_0xc93ddf[_0x18ed41(0xe4,0x90,0x119,0xcf)](addLog,_0x483c45(0x41d,0x446,0x3c9,0x3c5)+'\x20'+_0xc93ddf[_0x483c45(0x3f8,0x463,0x383,0x38e)](_0x40353f,'默认')+_0x483c45(0x408,0x3c5,0x3ad,0x469)+(_0x47593c||'默认')),_0x58a3d4=_0x26c741&&_0xc93ddf[_0x18ed41(0x105,0x89,0x13c,0x175)](_0x26c741[_0x18ed41(0x16d,0x178,0x1b0,0x199)](),'')?_0x26c741:_0x58a3d4,_0xc93ddf['uGbfk'](addLog,_0x483c45(0x3ec,0x388,0x3e4,0x3cb)+_0x58a3d4);let _0x2ee313=![];_0x58a3d4[_0x483c45(0x35c,0x335,0x3b6,0x345)](_0xc93ddf[_0x483c45(0x42d,0x3d9,0x40e,0x474)])&&(_0x2ee313=!![]);_0xc93ddf['jRZNq'](addLog,'是否启用分角色模式\x20'+_0x483c45(0x3ee,0x435,0x400,0x463)+_0x483c45(0x3d5,0x375,0x3e1,0x414)+_0x2ee313);let _0x18a02a={},_0x55087e='',_0x5a13db='';if(_0x2ee313){_0xc93ddf[_0x18ed41(0xa1,0xd3,0x103,0xd1)](addLog,_0xc93ddf[_0x483c45(0x339,0x310,0x372,0x2c0)]),_0x18a02a=parsePromptStringWithCoordinates(_0x58a3d4),_0x55087e=_0x18a02a[_0xc93ddf['JJyMy']];for(let _0x246420=-0x1*0x3d+-0x258d+0x25cb;_0xc93ddf[_0x18ed41(0x12f,0x17b,0xbe,0x13b)](_0x246420,0x1fda+-0x6f1*-0x1+0xced*-0x3);_0x246420++){_0x18a02a[_0x18ed41(0xc4,0x93,0xdb,0xac)+_0x246420+_0x483c45(0x37d,0x371,0x3c0,0x3ad)]&&(_0x5a13db=_0xc93ddf[_0x18ed41(0x11e,0x12f,0x19b,0x16d)](_0x5a13db,',\x20')+_0x18a02a[_0x18ed41(0xc4,0x70,0x4a,0x129)+_0x246420+'\x20Prompt']);}}else _0xc93ddf[_0x18ed41(0xbb,0xbf,0xe3,0x87)](addLog,_0xc93ddf[_0x18ed41(0x166,0x15d,0x164,0xf1)]),_0x55087e=_0x58a3d4;let {modifiedPrompt:_0x407e3c,insertions:_0x1c6ef9}=await _0xc93ddf[_0x483c45(0x38d,0x3a0,0x33d,0x3d8)](prompt_replace,_0x55087e,_0x5a13db);function _0x18ed41(_0x2db883,_0x1d79aa,_0x51456d,_0x250f9a){return _0x4528(_0x2db883- -0x83,_0x250f9a);}if(_0x2ee313){if(_0xc93ddf['JbMNV'](_0xc93ddf[_0x483c45(0x41c,0x485,0x3e0,0x3bc)],_0xc93ddf[_0x18ed41(0xc9,0x100,0x119,0xe6)]))_0x30c37e=_0xa25731['replaceAll'](_0xc93ddf[_0x483c45(0x3cf,0x35a,0x397,0x42d)],'');else for(let _0x34bd21=0x17de+-0x80*0x2b+-0x1*0x25d;_0xc93ddf[_0x18ed41(0x12f,0x189,0xb0,0x167)](_0x34bd21,0x1*-0x16f2+0x34f+0x13a7);_0x34bd21++){_0x18a02a[_0x18ed41(0xc4,0xbb,0xde,0x5e)+_0x34bd21+'\x20Prompt']&&(_0x407e3c=_0xc93ddf['YDUCj'](_0xc93ddf['mBsZp'](_0x407e3c,_0xc93ddf[_0x18ed41(0xc3,0x133,0x11e,0xda)]),prompt_replace_for_character(_0x18a02a[_0x483c45(0x371,0x3db,0x385,0x34d)+_0x34bd21+_0x483c45(0x37d,0x328,0x35a,0x350)])));}}const _0x891dde=extension_settings[extensionName][_0x18ed41(0x13e,0xed,0xc7,0x12c)],{model:_0x2af5ce,apiUrl:_0x2ed5fb,apiKey:_0x4fdd21,conversationPresets:_0x93dc73,conversationPresetId:_0x3eeca2,aspectRatio:_0x5ecafc}=_0x891dde;_0xc93ddf[_0x18ed41(0xbd,0xe8,0xb3,0x47)](addLog,_0x18ed41(0xec,0x91,0x93,0xb2)+_0x18ed41(0xa5,0x66,0x109,0x78)+_0x18ed41(0xe5,0x91,0x9e,0x6f)+_0x18ed41(0xdf,0xa1,0x86,0x121)+_0x483c45(0x367,0x3b1,0x36d,0x36b)+_0x2af5ce);let _0x35d22a,_0x1fa357;if(_0x2af5ce==='gemini-2.5'+_0x483c45(0x366,0x3d7,0x39e,0x3de)+'ge'||_0x26c741[_0x18ed41(0xaf,0x9e,0xc4,0xa5)](_0xc93ddf[_0x18ed41(0x122,0xc2,0x18c,0xf6)])){_0x35d22a=_0xc93ddf[_0x18ed41(0x86,0x39,0xdf,0x26)];let _0x4ae4ce;if(_0x26c741[_0x483c45(0x35c,0x2ec,0x38d,0x37d)](_0x483c45(0x3b5,0x413,0x42e,0x3cf))){if(_0xc93ddf['avAUa'](_0xc93ddf[_0x18ed41(0xf4,0x11e,0x75,0x96)],_0xc93ddf[_0x18ed41(0xf4,0x12a,0x144,0x12e)])){const _0x2cc025=_0x18ed41(0xda,0xf2,0xb4,0xac)+'eneration\x20'+_0x18ed41(0xa8,0x50,0xc6,0x56)+_0x483c45(0x341,0x367,0x346,0x33d)+_0x2dbf79+':\x20'+_0x598d2f['message'];_0x484efb(_0x2cc025),_0x17a7e1['error'](_0x2cc025);const _0x2b175e={};_0x2b175e['id']=_0x33a635,_0x2b175e[_0x18ed41(0xaa,0x77,0x111,0x2c)]=![],_0x2b175e['error']=_0x2db148[_0x483c45(0x3ed,0x42a,0x41d,0x395)],_0x2b175e[_0x483c45(0x3aa,0x410,0x41d,0x3ef)]=_0x4d5bfc,_0x51e834[_0x18ed41(0xd8,0x60,0xab,0x10d)](_0x48310c[_0x483c45(0x34a,0x32f,0x375,0x39f)+_0x18ed41(0x87,0x4a,0xd,0x4a)+_0x18ed41(0x8b,0xcf,0x8f,0x45)],_0x2b175e),_0xc93ddf[_0x18ed41(0x179,0x1b5,0x187,0x146)](_0x166163,_0x18ed41(0x109,0x98,0xd3,0xc5)+_0x483c45(0x393,0x37d,0x3f0,0x357)+_0x483c45(0x3af,0x35c,0x3e1,0x3d3)+'nse\x20for\x20ID'+':\x20'+_0x22cfc6);}else{_0xc93ddf[_0x483c45(0x391,0x403,0x352,0x32d)](addLog,_0xc93ddf[_0x483c45(0x3cc,0x370,0x3ec,0x3ba)]),console['log'](_0xc93ddf[_0x18ed41(0x138,0x11f,0xef,0x176)],_0x93dc73);const _0x39fb50={};_0x39fb50[_0x483c45(0x38f,0x3d2,0x317,0x316)+'on']=[],_0x39fb50[_0x18ed41(0x116,0xd5,0x114,0x129)+'t']='',_0x4ae4ce=_0x93dc73[_0x18ed41(0xf5,0x132,0x165,0xe5)]||_0x39fb50;}}else{const _0x14bbe1={};_0x14bbe1[_0x483c45(0x38f,0x31a,0x357,0x404)+'on']=[],_0x14bbe1[_0x483c45(0x3c3,0x3ee,0x434,0x3d2)+'t']='',_0x4ae4ce=_0x93dc73[_0x3eeca2]||_0x14bbe1;}const _0x25c5dd=[_0x4ae4ce[_0x483c45(0x3c3,0x34a,0x35b,0x3e7)+'t'],_0x1c6ef9[_0x483c45(0x3ff,0x3c2,0x44c,0x469)],_0x1c6ef9[_0xc93ddf[_0x483c45(0x38b,0x3a4,0x3e7,0x3a8)]],_0x407e3c,_0x1c6ef9[_0xc93ddf['ClAQM']],_0x1c6ef9[_0xc93ddf[_0x483c45(0x3ad,0x332,0x338,0x3fc)]],_0x4ae4ce['postfixPro'+_0x18ed41(0x12e,0xbd,0xbe,0x176)],_0x1c6ef9[_0x483c45(0x394,0x381,0x3f1,0x393)]][_0x18ed41(0x150,0x14b,0x1bc,0xf2)](Boolean)[_0x483c45(0x35a,0x2f8,0x35e,0x368)](',\x20');_0xc93ddf[_0x18ed41(0xbb,0xd9,0xd7,0xb9)](addLog,_0x18ed41(0x16c,0x1eb,0x1b4,0x1e4)+_0x25c5dd);const _0xa939da={};_0xa939da['role']='user',_0xa939da[_0x483c45(0x365,0x3bf,0x340,0x30c)]=[];const _0x5a128b={};_0x5a128b[_0x483c45(0x3f6,0x469,0x3c4,0x38c)]=_0x18ed41(0x14c,0xf3,0x187,0x167),_0x5a128b['parts']=[];const _0x4c6de7=_0x4ae4ce[_0x18ed41(0xe2,0xac,0x148,0x91)+'on'][_0x18ed41(0xb1,0x9e,0x60,0x123)](_0x3441db=>[_0xa939da,_0x5a128b])[_0x18ed41(0x178,0x14f,0x17c,0x170)]();let _0x18f042=0x26e+-0x183a+-0x22e*-0xa;_0x4ae4ce[_0x18ed41(0xe2,0x15e,0xb6,0x12f)+'on'][_0x18ed41(0xa2,0x5a,0x10d,0xbe)](_0x3562de=>{function _0x47d67c(_0x1b9c91,_0x1e466f,_0x1ffce2,_0x750637){return _0x18ed41(_0x1ffce2- -0x289,_0x1e466f-0x11e,_0x1ffce2-0x111,_0x1b9c91);}function _0x33709e(_0x39c62c,_0x3f6ed1,_0x32aedb,_0x4ea8b5){return _0x18ed41(_0x32aedb-0x12d,_0x3f6ed1-0x12a,_0x32aedb-0x1a2,_0x4ea8b5);}if(_0xc93ddf[_0x33709e(0x278,0x216,0x232,0x2a1)](_0x47d67c(-0x13e,-0x126,-0x13b,-0xff),_0x47d67c(-0x174,-0x14b,-0x1ca,-0x20b))){const _0x5572b4=_0xc93ddf[_0x33709e(0x24a,0x297,0x220,0x290)][_0x47d67c(-0x207,-0x1a1,-0x1f9,-0x255)]('|');let _0x8198cf=-0x2*-0x128f+0xdfb*-0x1+-0x1*0x1723;while(!![]){switch(_0x5572b4[_0x8198cf++]){case'0':if(_0x3562de['user'][_0x33709e(0x260,0x30e,0x2a7,0x2a2)])_0x4c6de7[_0x18f042][_0x33709e(0x1cc,0x1af,0x1e5,0x226)][_0x33709e(0x2d2,0x20c,0x27e,0x214)]({'type':_0xc93ddf[_0x33709e(0x1c9,0x1b9,0x1ef,0x1bc)],'image_url':{'url':_0x3562de[_0x33709e(0x2db,0x282,0x2ac,0x237)]['image']}});continue;case'1':_0x18f042++;continue;case'2':_0x18f042++;continue;case'3':if(_0x3562de[_0x33709e(0x253,0x2cb,0x279,0x273)]['image'])_0x4c6de7[_0x18f042][_0x47d67c(-0x1a2,-0x17e,-0x1d1,-0x1a9)][_0x33709e(0x2c6,0x2fa,0x27e,0x2e9)]({'type':_0xc93ddf[_0x47d67c(-0x203,-0x1e6,-0x1c7,-0x160)],'image_url':{'url':_0x3562de[_0x47d67c(-0xfd,-0x14b,-0x13d,-0xc2)][_0x33709e(0x31d,0x304,0x2a7,0x290)]}});continue;case'4':if(_0x3562de[_0x33709e(0x293,0x25f,0x279,0x258)][_0x47d67c(-0xf8,-0x111,-0x131,-0x150)])_0x4c6de7[_0x18f042][_0x47d67c(-0x17d,-0x176,-0x1d1,-0x1fe)][_0x33709e(0x2e4,0x2a7,0x27e,0x29d)]({'type':_0xc93ddf['bLYzd'],'text':_0x3562de[_0x33709e(0x2ed,0x223,0x279,0x2be)][_0x47d67c(-0x1af,-0x127,-0x131,-0xfd)]});continue;case'5':if(_0x3562de[_0x33709e(0x2ff,0x327,0x2ac,0x2a4)][_0x47d67c(-0x17c,-0x171,-0x131,-0xfd)])_0x4c6de7[_0x18f042][_0x47d67c(-0x1d0,-0x186,-0x1d1,-0x239)][_0x33709e(0x2ab,0x2f4,0x27e,0x2d3)]({'type':_0x47d67c(-0x17a,-0x185,-0x131,-0x180),'text':_0x3562de['user'][_0x47d67c(-0x196,-0x16e,-0x131,-0x1ac)]});continue;}break;}}else _0xc93ddf['vIqfD'](_0x43fe62,_0x33709e(0x21e,0x17b,0x1e3,0x1e9)+'启动');});if(!_0x26c741['includes']('{修图}')){const _0x52bc63=extension_settings[extensionName][_0x483c45(0x364,0x3e2,0x384,0x33c)+'acterPrese'+'ts']||{};let _0x12b84e=![];for(const _0x11018b in _0x52bc63){const _0x34b2c4=_0x52bc63[_0x11018b],_0x1739b0=(_0x34b2c4[_0x18ed41(0x173,0x1c5,0x159,0x183)]||'')[_0x483c45(0x33d,0x373,0x2ec,0x388)]('|')[_0x18ed41(0x150,0x164,0x1cb,0x14f)](_0x267a5c=>_0x267a5c[_0x18ed41(0x16d,0x129,0x1d6,0x14f)]()!=='');console[_0x483c45(0x3bb,0x3ba,0x422,0x436)](_0xc93ddf['tJioG'],_0x1739b0);for(const _0xb4282b of _0x1739b0){if(_0x25c5dd[_0x483c45(0x410,0x43d,0x3df,0x3c7)+'e']()[_0x18ed41(0xaf,0x9f,0x54,0x10b)](_0xb4282b[_0x483c45(0x410,0x3e2,0x3f5,0x3f1)+'e']())){_0xc93ddf[_0x18ed41(0xe4,0x83,0x15c,0x14a)](addLog,_0x483c45(0x33e,0x3b4,0x307,0x2ca)+_0x483c45(0x3a7,0x37c,0x357,0x3c0)+_0x483c45(0x350,0x369,0x3c9,0x2fa)+'r\x20\x22'+_0xb4282b+(_0x18ed41(0xb3,0x55,0xc2,0xd5)+_0x483c45(0x3fc,0x3eb,0x474,0x412)+'ter\x20Preset'+'\x20\x22')+_0x11018b+('\x22.\x20Adding\x20'+'its\x20conver'+_0x483c45(0x3f3,0x3b4,0x391,0x390)+_0x483c45(0x349,0x2ec,0x356,0x2d1)));const _0x2d5d81=_0x34b2c4['conversati'+'on'];if(_0x2d5d81){const _0x27dfc2=[];if(_0x2d5d81[_0x483c45(0x42c,0x477,0x47a,0x3fc)]&&_0x2d5d81[_0x18ed41(0x17f,0x114,0x16c,0x13a)][_0x483c45(0x405,0x427,0x3ea,0x46e)])_0x27dfc2['push']({'type':_0xc93ddf[_0x18ed41(0x16e,0x18a,0x14e,0x180)],'text':_0x2d5d81[_0x18ed41(0x17f,0x1c1,0x1a6,0x13f)]['text']});if(_0x2d5d81['user']&&_0x2d5d81[_0x483c45(0x42c,0x42a,0x48f,0x445)][_0x18ed41(0x17a,0x16e,0x1a3,0x197)])_0x27dfc2['push']({'type':_0xc93ddf[_0x18ed41(0xc2,0x76,0x66,0xf9)],'image_url':{'url':_0x2d5d81[_0x483c45(0x42c,0x483,0x43f,0x464)]['image']}});if(_0x27dfc2[_0x483c45(0x416,0x401,0x42b,0x3c7)]>0x1*-0xaaf+-0xb*-0x30d+0x2dc*-0x8){const _0x38f5f6={};_0x38f5f6[_0x18ed41(0x149,0xf9,0x1b4,0x118)]=_0x18ed41(0x17f,0x1e0,0x1e4,0x1f1),_0x38f5f6[_0x483c45(0x365,0x348,0x315,0x30d)]=_0x27dfc2,_0x4c6de7[_0x18ed41(0x151,0xf5,0x131,0x17e)](_0x38f5f6);}const _0x32337e=[];if(_0x2d5d81[_0x18ed41(0x14c,0x141,0x13d,0x18a)]&&_0x2d5d81[_0x483c45(0x3f9,0x46e,0x43e,0x463)][_0x18ed41(0x158,0x1a0,0x11b,0x143)])_0x32337e[_0x483c45(0x3fe,0x441,0x40b,0x3eb)]({'type':_0xc93ddf[_0x483c45(0x41b,0x3a6,0x424,0x405)],'text':_0x2d5d81[_0x483c45(0x3f9,0x39c,0x3e0,0x477)]['text']});if(_0x2d5d81[_0x18ed41(0x14c,0x184,0x167,0x19e)]&&_0x2d5d81[_0x483c45(0x3f9,0x43c,0x433,0x3c9)][_0x483c45(0x427,0x40f,0x404,0x4a3)])_0x32337e[_0x483c45(0x3fe,0x3fc,0x410,0x3fa)]({'type':_0xc93ddf[_0x18ed41(0xc2,0x7b,0xe1,0xfd)],'image_url':{'url':_0x2d5d81[_0x483c45(0x3f9,0x3a7,0x416,0x3f0)][_0x18ed41(0x17a,0x123,0x14e,0x146)]}});if(_0xc93ddf[_0x483c45(0x3da,0x3ba,0x386,0x411)](_0x32337e[_0x18ed41(0x169,0x110,0x14a,0x1b5)],-0x84+-0x688+0x70c)){const _0x536cda={};_0x536cda[_0x483c45(0x3f6,0x3e3,0x3b5,0x3e1)]=_0xc93ddf[_0x483c45(0x33b,0x3b9,0x2c6,0x2e2)],_0x536cda[_0x483c45(0x365,0x34c,0x335,0x334)]=_0x32337e,_0x4c6de7['push'](_0x536cda);}}break;}}}}if(!_0x26c741['includes'](_0xc93ddf['WTsmh'])){const _0x206893={};_0x206893[_0x483c45(0x3f6,0x454,0x3b1,0x455)]=_0xc93ddf['RXZVR'],_0x206893[_0x483c45(0x365,0x39a,0x33d,0x39e)]=[{'type':_0xc93ddf[_0x18ed41(0x16e,0x152,0x1cd,0x10b)],'text':_0x25c5dd}],_0x4c6de7['push'](_0x206893);}else _0x4c6de7[-0x1*-0x1b0d+-0x181b+-0x2f2][_0x483c45(0x365,0x3e3,0x2ee,0x2f8)][0x158*-0xe+-0x1a7b*0x1+-0x305*-0xf][_0x18ed41(0x158,0x112,0x134,0x1b7)]=_0xc93ddf[_0x483c45(0x389,0x3d0,0x353,0x30f)](_0xc93ddf[_0x18ed41(0x157,0xe6,0xdc,0x1a0)](_0x4ae4ce['fixedPromp'+'t'],_0x4c6de7[-0x1333+-0x2693+0x66*0x91][_0x483c45(0x365,0x362,0x333,0x3ce)][-0x83*-0x5+0x6*0x4d3+-0x1f81*0x1]['text']),_0x4ae4ce[_0x18ed41(0x119,0x151,0x13f,0x14a)+_0x18ed41(0x12e,0x13b,0x1aa,0xbd)]);const _0x214366={};_0x214366[_0x483c45(0x378,0x36c,0x385,0x311)+'o']=_0x5ecafc;const _0x5e4725={};_0x5e4725[_0x483c45(0x398,0x34c,0x3d5,0x394)+'g']=_0x214366,_0x1fa357={'model':_0x2af5ce,'history':_0x4c6de7[_0x18ed41(0x150,0x19d,0x118,0x118)](_0x4bf7e2=>_0x4bf7e2['parts'][_0x483c45(0x416,0x47d,0x444,0x41f)]>-0x1*0x1c27+0x4c4+0x1763),'config':_0x5e4725},_0xc93ddf[_0x483c45(0x407,0x3fc,0x3b5,0x45a)](addLog,_0x18ed41(0xc6,0xaf,0xc2,0x4b)+_0x483c45(0x396,0x3bf,0x324,0x335)+_0x483c45(0x3bc,0x39c,0x376,0x38e)+'with\x20'+_0x1fa357[_0x18ed41(0x13b,0x120,0x1a8,0x103)][_0x18ed41(0x169,0x1aa,0x18c,0x108)]+_0x483c45(0x356,0x2f3,0x380,0x365));}else{if(_0x2af5ce[_0x18ed41(0x168,0x105,0x104,0x1db)](_0xc93ddf[_0x483c45(0x406,0x44b,0x468,0x3d8)])){if(_0xc93ddf[_0x483c45(0x37a,0x3d3,0x3f0,0x3f1)]!==_0xc93ddf[_0x18ed41(0xa6,0x35,0xfc,0xb0)]){_0x35d22a='/v1beta/mo'+'dels/'+_0x2af5ce;const _0x46e8f3={};_0x46e8f3[_0x483c45(0x3c3,0x3d1,0x406,0x3a8)+'t']='';const _0xe06870=_0x93dc73[_0x3eeca2]||_0x46e8f3,_0x40e738=[_0xe06870[_0x483c45(0x3c3,0x359,0x3d9,0x41c)+'t'],_0x1c6ef9[_0xc93ddf[_0x18ed41(0xf0,0x16a,0x109,0x82)]],_0x1c6ef9[_0x483c45(0x335,0x2fa,0x300,0x2b9)],_0x407e3c,_0x1c6ef9[_0x483c45(0x35d,0x3ae,0x32d,0x35d)],_0x1c6ef9[_0xc93ddf['lLqkO']],_0xe06870[_0x18ed41(0x119,0x100,0x18a,0x140)+'mpt'],_0x1c6ef9[_0xc93ddf['ZQCPm']]][_0x18ed41(0x150,0x1b0,0xdb,0x109)](Boolean)[_0x483c45(0x35a,0x3d4,0x36b,0x38a)](',\x20');_0xc93ddf[_0x18ed41(0xcf,0x96,0x11c,0xb5)](addLog,_0x18ed41(0x16c,0x1bd,0x16e,0x1bd)+_0x40e738);const _0x28c528={};_0x28c528[_0x18ed41(0xfd,0xc0,0x8e,0x126)]=_0x40e738;const _0x103bf9={};_0x103bf9[_0x18ed41(0x12a,0x13b,0x15f,0xf3)+'t']=0x1,_0x103bf9[_0x18ed41(0xcb,0x140,0x7c,0x4c)+'o']=_0x5ecafc;const _0x4d56df={};_0x4d56df[_0x483c45(0x39e,0x407,0x39f,0x3e8)]=[_0x28c528],_0x4d56df[_0x483c45(0x3df,0x3a8,0x37f,0x446)]=_0x103bf9,_0x1fa357=_0x4d56df,_0xc93ddf[_0x18ed41(0xa1,0xdf,0xaf,0x10b)](addLog,_0x18ed41(0xc6,0x50,0xc8,0xd4)+_0x483c45(0x36b,0x393,0x39f,0x37e)+_0x18ed41(0x8d,0xec,0x6a,0x6b)+_0x483c45(0x3e7,0x399,0x401,0x406)+_0x483c45(0x3a6,0x40b,0x3a8,0x3a1)+_0x40e738);}else _0x3884f7[0x6*0x55d+-0x4b6+-0x1b78][_0x18ed41(0xb8,0x55,0x52,0x65)][-0x15f9+-0x10a4+0x269d][_0x18ed41(0x158,0x1be,0x122,0xe0)]=_0xc93ddf[_0x483c45(0x3e4,0x3ce,0x429,0x3cd)](_0x265e9f[_0x483c45(0x3c3,0x3b9,0x3f0,0x41c)+'t'],_0x235713[0x121e+0x1e1e+-0x6e4*0x7][_0x18ed41(0xb8,0x11e,0x112,0x130)][0x2529+-0x1*0x250a+0x1f*-0x1][_0x483c45(0x405,0x390,0x3c5,0x3df)])+_0x3b2cf1[_0x483c45(0x3c6,0x38a,0x410,0x35d)+_0x18ed41(0x12e,0x184,0x11b,0x19d)];}else throw new Error(_0x483c45(0x395,0x414,0x38c,0x3cb)+'nsupported'+_0x483c45(0x3f7,0x42a,0x3d8,0x43f)+'ected:\x20'+_0x2af5ce);}const _0x4c6fd6=new URL(_0x35d22a,_0x2ed5fb)['toString']();_0xc93ddf[_0x483c45(0x37c,0x36e,0x314,0x3f7)](addLog,_0x18ed41(0xec,0xf3,0x168,0x108)+_0x483c45(0x3f1,0x451,0x38d,0x433)+_0x483c45(0x421,0x3a5,0x3c7,0x457)+_0x4c6fd6),addLog('[Banana]\x20P'+_0x483c45(0x3a4,0x370,0x373,0x37c)+JSON[_0x483c45(0x3fa,0x43c,0x3a1,0x435)](_0x1fa357,null,-0x4*0x47d+0x7f+-0x107*-0x11));try{if('Trnfi'===_0x18ed41(0xe3,0x6e,0xb3,0x119)){const _0x252f39={};_0x252f39['role']=_0xc93ddf[_0x483c45(0x35f,0x385,0x304,0x30a)],_0x252f39[_0x483c45(0x365,0x302,0x3c2,0x3cd)]=[{'type':_0xc93ddf['bLYzd'],'text':_0x2aad2e}],_0x216f8f['push'](_0x252f39);}else{const _0x379182=await _0xc93ddf['alwBa'](fetch,_0x4c6fd6,{'method':_0xc93ddf[_0x483c45(0x414,0x421,0x45a,0x3ed)],'headers':{'Content-Type':_0xc93ddf[_0x18ed41(0x107,0x13f,0x14e,0x13e)],'Authorization':_0x483c45(0x3c8,0x3ed,0x361,0x359)+_0x4fdd21},'body':JSON[_0x483c45(0x3fa,0x445,0x3f4,0x40a)](_0x1fa357)});if(!_0x379182['ok']){if(_0xc93ddf['JbMNV'](_0xc93ddf[_0x18ed41(0x10a,0x100,0x103,0x11c)],_0xc93ddf[_0x18ed41(0x10a,0x143,0xe1,0x16d)])){const _0x19f4a7=await _0x379182[_0x18ed41(0x158,0x12a,0x157,0xe8)]();throw new Error('API\x20reques'+'t\x20failed\x20w'+'ith\x20status'+'\x20'+_0x379182[_0x483c45(0x42e,0x3df,0x47a,0x448)]+':\x20'+_0x19f4a7);}else for(let _0x21e37a=0xcfa+-0x83*0x32+0xc9d;_0xc93ddf[_0x483c45(0x3dc,0x443,0x43b,0x3ff)](_0x21e37a,-0xacb+-0x97b+-0x173*-0xe);_0x21e37a++){_0x250fab[_0x483c45(0x371,0x32d,0x3a5,0x3e8)+_0x21e37a+_0x18ed41(0xd0,0x12d,0x9f,0xa2)]&&(_0x5ef727=_0xc93ddf[_0x18ed41(0x13d,0x15c,0x1af,0x19c)](_0x5f4bf5,_0x18ed41(0x161,0x195,0x1b0,0x1a8))+_0xc93ddf[_0x18ed41(0xe4,0xd0,0x11c,0x11f)](_0x9c66fe,_0x3a8ed4[_0x483c45(0x371,0x37a,0x30a,0x2f6)+_0x21e37a+_0x483c45(0x37d,0x36a,0x362,0x31b)]));}}const _0x23f4d0=await _0x379182[_0x18ed41(0x162,0x104,0x178,0xf8)]();if(!_0x23f4d0['resultUrl']){if(_0xc93ddf[_0x18ed41(0x145,0x194,0xdb,0x12c)]===_0xc93ddf['hIYuS'])throw new _0x1a45ca('[Banana]\x20U'+_0x18ed41(0x10d,0x177,0x9f,0x14f)+'\x20model\x20sel'+'ected:\x20'+_0x42f406);else throw new Error(_0xc93ddf[_0x18ed41(0x96,0x78,0x73,0x75)]);}addLog(_0xc93ddf[_0x18ed41(0x16a,0x102,0x130,0x1c4)]);const _0x1459fb={};return _0x1459fb[_0x18ed41(0x17a,0x17f,0x16d,0x154)]=_0x23f4d0['resultUrl'],_0x1459fb['change']=_0x5d0f1d||'',_0x1459fb;}}catch(_0xdebf98){_0xc93ddf[_0x483c45(0x3d3,0x398,0x40f,0x3ec)](addLog,'[Banana]\x20F'+_0x18ed41(0xac,0x9a,0x65,0x4c)+':\x20'+_0xdebf98['message']),console['error'](_0xc93ddf[_0x483c45(0x337,0x2cd,0x33f,0x36e)],_0xdebf98);throw _0xdebf98;}}function _0x4528(_0x6ce2b5,_0x127eaa){const _0x1fd98d=_0x1934();return _0x4528=function(_0xdc1841,_0x23f511){_0xdc1841=_0xdc1841-(0x1c76+0x228f+-0x3dfe);let _0x2356a9=_0x1fd98d[_0xdc1841];if(_0x4528['FhnpeR']===undefined){var _0x5436a5=function(_0x38adc7){const _0x82316c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x52c3c='',_0x1d6a70='',_0x6ac1b6=_0x52c3c+_0x5436a5;for(let _0x32e6c1=0x73*-0x29+0x1197+0xd4,_0x580531,_0x54a211,_0x33ce97=0x221f+0x264b*-0x1+0x3*0x164;_0x54a211=_0x38adc7['charAt'](_0x33ce97++);~_0x54a211&&(_0x580531=_0x32e6c1%(0x203*-0x5+-0x10*-0xfb+0x3*-0x1df)?_0x580531*(-0x257a+-0x12f*0x8+0x2f32)+_0x54a211:_0x54a211,_0x32e6c1++%(0x3ce+-0x3*0x8fd+-0x1*-0x172d))?_0x52c3c+=_0x6ac1b6['charCodeAt'](_0x33ce97+(-0xe55+-0x1a98+-0x1*-0x28f7))-(-0x2*-0xc4+-0x531*0x1+0x3b3)!==-0x7d8+0x1aba+-0x12e2?String['fromCharCode'](0xf51+0x183a*0x1+-0x268c&_0x580531>>(-(-0x17b7*-0x1+-0x125*-0xb+-0x244c)*_0x32e6c1&-0x2291+0x1124*-0x2+-0x3*-0x16f5)):_0x32e6c1:0x1*-0x277+0x6f5*0x5+-0x7*0x49e){_0x54a211=_0x82316c['indexOf'](_0x54a211);}for(let _0x3f209e=-0x1e0+-0x1ac*0x8+0x8*0x1e8,_0x2fbb87=_0x52c3c['length'];_0x3f209e<_0x2fbb87;_0x3f209e++){_0x1d6a70+='%'+('00'+_0x52c3c['charCodeAt'](_0x3f209e)['toString'](0x22*0xa3+0xa6f+0x7*-0x493))['slice'](-(0x1de*-0x5+-0x1882+0x21da));}return decodeURIComponent(_0x1d6a70);};_0x4528['KNgkfN']=_0x5436a5,_0x6ce2b5=arguments,_0x4528['FhnpeR']=!![];}const _0x252b19=_0x1fd98d[0x1b83+0x3b*-0x89+-0x1*-0x410],_0x320155=_0xdc1841+_0x252b19,_0x1ce71f=_0x6ce2b5[_0x320155];if(!_0x1ce71f){const _0x181dc7=function(_0x213f8b){this['SsQlvz']=_0x213f8b,this['uFUmJw']=[0x30f+-0x2519+0x220b,0x2fc*-0x5+0x827*0x1+0x6c5,-0x18e4+-0x156b+0x1*0x2e4f],this['pjeGNX']=function(){return'newState';},this['ZXtvjs']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['aucALR']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x181dc7['prototype']['PeEJtZ']=function(){const _0x411515=new RegExp(this['ZXtvjs']+this['aucALR']),_0x3108ff=_0x411515['test'](this['pjeGNX']['toString']())?--this['uFUmJw'][-0xe66+0x6bc+0x7ab]:--this['uFUmJw'][0x137*0x1+-0x1*0x8b5+0x77e*0x1];return this['cPxFUl'](_0x3108ff);},_0x181dc7['prototype']['cPxFUl']=function(_0x4aecde){if(!Boolean(~_0x4aecde))return _0x4aecde;return this['zcboQI'](this['SsQlvz']);},_0x181dc7['prototype']['zcboQI']=function(_0x551f23){for(let _0x1b46b0=-0x1f10+0x3*0x2f8+0x1628,_0x1c9239=this['uFUmJw']['length'];_0x1b46b0<_0x1c9239;_0x1b46b0++){this['uFUmJw']['push'](Math['round'](Math['random']())),_0x1c9239=this['uFUmJw']['length'];}return _0x551f23(this['uFUmJw'][-0x1a9c+0x9c5+-0x1df*-0x9]);},new _0x181dc7(_0x4528)['PeEJtZ'](),_0x2356a9=_0x4528['KNgkfN'](_0x2356a9),_0x6ce2b5[_0x320155]=_0x2356a9;}else _0x2356a9=_0x1ce71f;return _0x2356a9;},_0x4528(_0x6ce2b5,_0x127eaa);}export async function bananaGenerate(_0x3eb756){const _0x544ac4={'NZBSy':_0x3a1bac(-0xc1,-0x6,-0x6,-0x55),'ARDIW':_0x3a1bac(-0x75,-0x12,0x4,-0x2d),'JpOpV':'最后置','AzcIy':_0x3a1bac(0x9b,0x36,0x75,0x3d)+_0x3a1bac(0x9,0xd,0x14,0x0),'vMUJS':function(_0x4e9e8,_0x57fbda){return _0x4e9e8+_0x57fbda;},'NJlIC':'\x20|\x20','oJuzD':function(_0x2215e9,_0x388b09){return _0x2215e9(_0x388b09);},'rdUtU':function(_0x212d14){return _0x212d14();},'hLEQc':function(_0x28e002,_0x58637a){return _0x28e002(_0x58637a);},'OEOoK':_0x4566ae(0x355,0x34e,0x2d6,0x2b6),'FVoRc':function(_0x50caa3,_0x5001d1){return _0x50caa3(_0x5001d1);},'LCYoO':_0x4566ae(0x30f,0x254,0x2a5,0x30f),'qsGww':function(_0x355feb,_0x3eecbd){return _0x355feb!=_0x3eecbd;},'kgQsC':function(_0x4a038c,_0x503920,_0x19c762,_0x57e59d){return _0x4a038c(_0x503920,_0x19c762,_0x57e59d);},'mskts':function(_0x2b300c,_0x217a68){return _0x2b300c(_0x217a68);},'qIDjF':function(_0x1bf288,_0x266777){return _0x1bf288+_0x266777;},'UOarI':function(_0x46d490,_0x347262){return _0x46d490(_0x347262);},'sfHSC':_0x3a1bac(-0xa,0x8a,0x61,0x3b),'ZAvFO':function(_0x99d4cd,_0x4ac184){return _0x99d4cd(_0x4ac184);},'GWWBO':function(_0x4fe8f9,_0x3d4e78){return _0x4fe8f9===_0x3d4e78;},'aZvjy':_0x4566ae(0x3ad,0x368,0x333,0x332),'xinxS':'rfpND','vMsiN':function(_0x382ac4,_0x5e2e3c){return _0x382ac4(_0x5e2e3c);}};_0x544ac4[_0x3a1bac(-0x2f,-0x13,-0x5b,-0xb)](clearLog);let {id:_0x243d98,prompt:_0x259f66,width:_0x29dc90,height:_0x1c8ce9,change:_0x4413b8}=_0x3eb756;_0x544ac4[_0x4566ae(0x29c,0x297,0x252,0x264)](addLog,_0x4566ae(0x340,0x382,0x34b,0x2ce)+'eceived\x20im'+_0x3a1bac(-0x49,0x3,0x1c,0x8)+_0x4566ae(0x331,0x357,0x349,0x319)+'st\x20(ID:\x20'+_0x243d98+')');function _0x4566ae(_0x54a680,_0x436472,_0x7970c4,_0x455af7){return _0x4528(_0x7970c4-0x14b,_0x54a680);}let _0x4f2fd1='';_0x4413b8?_0x4f2fd1=_0x4413b8[_0x4566ae(0x2c0,0x320,0x2b8,0x336)]('{修图}',''):_0x4f2fd1=_0x259f66;_0x4413b8&&_0x4413b8[_0x4566ae(0x215,0x2fc,0x27d,0x267)](_0x544ac4[_0x3a1bac(-0x3,0x32,-0x41,-0xc)])&&_0x544ac4['FVoRc'](addLog,'Banana修图模式'+'启动');function _0x3a1bac(_0x52de3f,_0x597c3d,_0x6a0533,_0x3cdf5a){return _0x4528(_0x3cdf5a- -0x160,_0x6a0533);}try{if(_0x544ac4[_0x3a1bac(-0x3d,-0x3a,0x26,-0x18)]===_0x544ac4[_0x4566ae(0x22f,0x2b9,0x293,0x2dc)]){const {image:_0x1d77d6,change:_0x147290}=await _0x544ac4[_0x4566ae(0x250,0x2cd,0x2a2,0x2ab)](generateBananaImage,{'prompt':_0x259f66,'width':_0x29dc90,'height':_0x1c8ce9,'change':_0x4413b8});if(_0x544ac4[_0x4566ae(0x302,0x2e0,0x340,0x39d)](extension_settings[extensionName]['cache'],'0')){const _0x28f654={};_0x28f654[_0x4566ae(0x2cd,0x20e,0x275,0x293)]=_0x4f2fd1,await _0x544ac4['kgQsC'](setItemImg,_0x259f66,_0x1d77d6,_0x28f654),_0x544ac4[_0x4566ae(0x331,0x365,0x324,0x2f5)](addLog,_0x4566ae(0x2d3,0x2ea,0x279,0x29e)+_0x3a1bac(-0x2e,0x74,-0x4c,0x33)+'\x20'+_0x259f66),extension_settings[extensionName][_0x3a1bac(0x71,0x1d,0x29,0x61)]['cishu']?(extension_settings[extensionName][_0x3a1bac(0x1e,0x5,-0x19,0x61)][_0x4566ae(0x256,0x2e1,0x26e,0x276)]=_0x544ac4['qIDjF'](extension_settings[extensionName]['banana']['cishu'],-0x1*0x1f2d+-0x19f5+-0x1*-0x3923),_0x544ac4[_0x3a1bac(0xd7,0x37,0xf3,0x78)](addLog,_0x3a1bac(-0x64,0x25,-0x1,-0x46)+_0x4566ae(0x2a3,0x313,0x29c,0x2fa)+extension_settings[extensionName]['banana']['cishu'])):(extension_settings[extensionName][_0x4566ae(0x383,0x294,0x30c,0x347)]['cishu']=0x11be+0x1f79+-0x3136,_0x544ac4['UOarI'](addLog,_0x4566ae(0x233,0x247,0x265,0x27f)+_0x3a1bac(-0x66,0x53,-0x20,-0xf)+extension_settings[extensionName]['banana'][_0x4566ae(0x2a9,0x275,0x26e,0x2bd)]));}else{if('QMDAt'!==_0x544ac4[_0x4566ae(0x380,0x30e,0x343,0x39e)])_0x544ac4[_0x4566ae(0x2a9,0x26c,0x252,0x244)](addLog,_0x3a1bac(0x63,0xd,0x13,0x65)+'库');else{_0x12541e=_0x4566ae(0x2e0,0x217,0x28a,0x2cc)+_0x4566ae(0x231,0x30a,0x298,0x277)+_0x470a63;const _0x2e7914={};_0x2e7914[_0x3a1bac(0x7b,0x40,-0x4,0x39)+'t']='';const _0x434378=_0x27688a[_0x54426e]||_0x2e7914,_0x64ee84=[_0x434378[_0x3a1bac(-0x28,0x70,0xaf,0x39)+'t'],_0x29acec[_0x3a1bac(0xa,0x13,0xd3,0x75)],_0x3c0ea2[_0x544ac4[_0x3a1bac(0x49,0x5d,0x107,0x9f)]],_0x555f24,_0x558b08[_0x544ac4[_0x4566ae(0x2f4,0x29f,0x2bd,0x2ac)]],_0x42d777[_0x4566ae(0x30e,0x28c,0x2cc,0x2fb)],_0x434378[_0x3a1bac(0x48,0x8e,-0x20,0x3c)+_0x3a1bac(0x98,0x94,-0x1b,0x51)],_0x4c7269[_0x544ac4[_0x4566ae(0x2e8,0x335,0x2e2,0x2aa)]]][_0x3a1bac(0x16,0x32,0xcf,0x73)](_0x374585)['join'](',\x20');_0x52d3b0('正面提示词:\x20'+_0x64ee84);const _0x4211f9={};_0x4211f9[_0x4566ae(0x30d,0x2f2,0x2cb,0x319)]=_0x64ee84;const _0x2d954b={};_0x2d954b[_0x4566ae(0x2ca,0x373,0x2f8,0x293)+'t']=0x1,_0x2d954b[_0x3a1bac(-0x79,-0x7c,0x47,-0x12)+'o']=_0x48dbf9;const _0x54b46f={};_0x54b46f[_0x4566ae(0x2e8,0x2d3,0x2bf,0x324)]=[_0x4211f9],_0x54b46f[_0x3a1bac(-0x11,0x5b,0xd1,0x55)]=_0x2d954b,_0x280915=_0x54b46f,_0x319773('[Banana]\x20B'+_0x4566ae(0x28d,0x221,0x28c,0x2d2)+_0x3a1bac(-0xb1,-0xa8,-0x7e,-0x50)+_0x4566ae(0x30b,0x352,0x308,0x307)+_0x3a1bac(-0x5f,-0x54,-0x1d,0x1c)+_0x64ee84);}}const _0xc5cda9={};_0xc5cda9['id']=_0x243d98,_0xc5cda9[_0x3a1bac(-0xa0,0x16,-0x71,-0x33)]=!![],_0xc5cda9[_0x3a1bac(0x80,0x6e,0x80,0x38)]=_0x1d77d6,_0xc5cda9[_0x4566ae(0x2b7,0x290,0x2cb,0x32d)]=_0x259f66,_0xc5cda9['change']=_0x4f2fd1,eventSource['emit'](EventType[_0x3a1bac(0x12,-0x52,-0x4c,-0x40)+'MAGE_RESPO'+_0x3a1bac(-0xb3,-0x83,-0x24,-0x52)],_0xc5cda9),_0x544ac4['ZAvFO'](addLog,_0x4566ae(0x2d3,0x340,0x2d7,0x261)+'mitted\x20suc'+_0x3a1bac(-0x90,-0x97,-0x44,-0x4e)+_0x3a1bac(0x5d,-0x4,0x0,-0x7)+':\x20'+_0x243d98);}else _0x1658f3[_0x3a1bac(0x37,0x38,0xdf,0x77)+_0x4566ae(0x2e8,0x33e,0x2ca,0x282)](_0x4219be[_0x3a1bac(-0x61,-0x17,0x11,-0x40)+_0x4566ae(0x31e,0x2a9,0x2fe,0x299)+'ST'],_0x572a21),_0x494c6e['initialize'+_0x3a1bac(-0x2e,0x3f,0x6e,-0x4)+_0x4566ae(0x2da,0x2c6,0x2ca,0x33b)]=![],_0x1943cb(_0x544ac4[_0x3a1bac(0x4b,-0x14,0x40,0x54)]);}catch(_0x181a45){if(_0x544ac4[_0x4566ae(0x323,0x369,0x315,0x393)](_0x544ac4[_0x3a1bac(0xe4,0xfd,0x9d,0x94)],_0x544ac4['xinxS']))_0x32e6c1=_0x544ac4['vMUJS'](_0x580531+_0x544ac4[_0x4566ae(0x2cc,0x335,0x303,0x2a1)],_0x544ac4['oJuzD'](_0x54a211,_0x33ce97[_0x3a1bac(0x31,0x1a,0x2b,-0x19)+_0x3f209e+_0x4566ae(0x2ff,0x282,0x29e,0x28f)]));else{const _0x42ee52=_0x3a1bac(-0x1c,-0x3e,0x0,-0x3)+_0x3a1bac(-0x3a,-0x12,-0x1c,0x4)+_0x4566ae(0x2a2,0x22f,0x276,0x20f)+_0x3a1bac(-0x45,-0x2f,0x16,-0x49)+_0x243d98+':\x20'+_0x181a45[_0x3a1bac(0x94,0x56,0xd3,0x63)];_0x544ac4[_0x4566ae(0x2a3,0x294,0x2f5,0x343)](addLog,_0x42ee52),console[_0x3a1bac(0x1d,-0x3f,0x93,0x26)](_0x42ee52);const _0xc7f073={};_0xc7f073['id']=_0x243d98,_0xc7f073[_0x4566ae(0x265,0x243,0x278,0x274)]=![],_0xc7f073['error']=_0x181a45[_0x4566ae(0x321,0x358,0x30e,0x313)],_0xc7f073[_0x4566ae(0x2dc,0x259,0x2cb,0x2ad)]=_0x259f66,eventSource[_0x4566ae(0x2c8,0x2fb,0x2a6,0x259)](EventType['GENERATE_I'+_0x3a1bac(-0x7c,-0x3d,-0x3e,-0x56)+_0x4566ae(0x258,0x266,0x259,0x22f)],_0xc7f073),addLog(_0x3a1bac(0x9d,-0x2f,0x42,0x2c)+_0x3a1bac(-0x6b,0x83,0xb,0x9)+_0x4566ae(0x30a,0x2a9,0x2d0,0x2e8)+'nse\x20for\x20ID'+':\x20'+_0x243d98);}}}function initializeBananaListener(){function _0x17eeb8(_0x166c5c,_0x4a75c5,_0x1e6e3c,_0x56e93d){return _0x4528(_0x56e93d-0x123,_0x4a75c5);}eventSource['on'](EventType['GENERATE_I'+_0x17eeb8(0x354,0x269,0x297,0x2d6)+'ST'],bananaGenerate),addLog('banana\x20生图事'+'件监听器已初始化。');}export async function replaceWithBanana(){function _0x5ef897(_0x6de377,_0x36d3cc,_0x267afe,_0x332e40){return _0x4528(_0x267afe-0xc0,_0x6de377);}function _0xbdfd7c(_0x2c6862,_0x4b3aca,_0x47d56b,_0x4552fc){return _0x4528(_0x47d56b-0x3db,_0x4552fc);}const _0x246c9f={'FAwyy':_0x5ef897(0x214,0x20f,0x23b,0x1ce)+_0x5ef897(0x2ef,0x319,0x2a0,0x317),'gMRYT':function(_0x18646a,_0x599b9f){return _0x18646a<=_0x599b9f;},'shXyj':function(_0xa889cd,_0x99ca59){return _0xa889cd+_0x99ca59;},'SgTvP':function(_0x593ba3,_0x76d7){return _0x593ba3==_0x76d7;},'dqSRa':'banana','cgXOT':function(_0x5a9748,_0x57423c){return _0x5a9748===_0x57423c;},'mHBaz':'svZQN','QtMWL':'byNLo','KOpir':function(_0x4c76ab,_0xe324e2){return _0x4c76ab===_0xe324e2;},'nByWb':function(_0x242169){return _0x242169();},'jErZs':_0xbdfd7c(0x4bb,0x513,0x525,0x4bc),'XpElB':'[Banana]\x20生'+_0xbdfd7c(0x4db,0x590,0x53b,0x4da)};if(_0x246c9f[_0x5ef897(0x19c,0x1e4,0x204,0x249)](extension_settings[extensionName]['mode'],_0x246c9f['dqSRa'])){if(_0x246c9f[_0x5ef897(0x303,0x2db,0x2a1,0x27a)](_0x246c9f[_0x5ef897(0x247,0x1c8,0x1f7,0x18d)],_0x246c9f['QtMWL'])){const _0x3e6ab6={};_0x3e6ab6['conversati'+'on']=[],_0x3e6ab6[_0x5ef897(0x2d5,0x287,0x259,0x255)+'t']='',_0x31258d=_0x2a927d[_0x1698df]||_0x3e6ab6;}else{if(!window[_0x5ef897(0x25b,0x281,0x216,0x266)+_0x5ef897(0x1b5,0x1b1,0x21c,0x1c1)+_0x5ef897(0x204,0x1de,0x23f,0x22a)]){if(_0x246c9f[_0xbdfd7c(0x5c4,0x4e9,0x562,0x5cb)](_0xbdfd7c(0x4c8,0x4fd,0x50c,0x4f6),_0xbdfd7c(0x559,0x4cf,0x50c,0x51f)))window[_0xbdfd7c(0x4e9,0x502,0x531,0x4ef)+_0x5ef897(0x1a0,0x24f,0x21c,0x294)+_0xbdfd7c(0x4f2,0x53e,0x55a,0x5b8)]=!![],_0x246c9f['nByWb'](initializeBananaListener);else{const _0x13dd1f=_0x498bb7[_0x5ef897(0x22d,0x22f,0x296,0x2cb)](_0x9b065c,arguments);return _0x2703d2=null,_0x13dd1f;}}_0x246c9f[_0x5ef897(0x1fd,0x2ba,0x24f,0x2c1)](initializeImageProcessing);}}else{if(window[_0xbdfd7c(0x58f,0x545,0x531,0x4f3)+_0x5ef897(0x212,0x272,0x21c,0x1ca)+_0x5ef897(0x1ca,0x1e0,0x23f,0x213)]){if(_0x246c9f[_0xbdfd7c(0x5bd,0x58b,0x582,0x5d1)]!=='RHlqg'){_0x2461bb(_0x246c9f[_0x5ef897(0x1f7,0x2d8,0x26c,0x253)]),_0x5805eb=_0x5d88fe(_0x1794f5),_0x5d3eb9=_0x55ca70[_0x5ef897(0x1b8,0x26b,0x231,0x25c)+'osition'];for(let _0x44789f=0x68b+-0x1*0xc9+-0x5c1;_0x246c9f[_0xbdfd7c(0x523,0x51f,0x564,0x577)](_0x44789f,-0x34*0x25+-0x64c+0xdd4);_0x44789f++){_0x51eec6['Character\x20'+_0x44789f+_0x5ef897(0x1a8,0x1b1,0x213,0x21d)]&&(_0x275a36=_0x246c9f[_0xbdfd7c(0x50f,0x5a9,0x54b,0x5a5)](_0x4b43c0,',\x20')+_0xe38548['Character\x20'+_0x44789f+'\x20Prompt']);}}else eventSource[_0xbdfd7c(0x61c,0x551,0x5b2,0x5ac)+_0xbdfd7c(0x5bf,0x543,0x55a,0x596)](EventType[_0x5ef897(0x20b,0x21b,0x1e0,0x1ef)+_0xbdfd7c(0x609,0x604,0x58e,0x537)+'ST'],bananaGenerate),window[_0xbdfd7c(0x596,0x4ef,0x531,0x4e5)+_0xbdfd7c(0x58d,0x585,0x537,0x503)+'ener']=![],addLog(_0x246c9f[_0x5ef897(0x1c0,0x1e0,0x20f,0x1be)]);}}}
//# sourceMappingURL=http://localhost:8000/banana.js.map